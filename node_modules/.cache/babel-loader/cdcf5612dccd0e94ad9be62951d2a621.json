{"ast":null,"code":"import _classCallCheck from \"/Users/anna_gavrilova/my-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/anna_gavrilova/my-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/anna_gavrilova/my-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/anna_gavrilova/my-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/anna_gavrilova/my-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/anna_gavrilova/my-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/anna_gavrilova/my-chat/src/components/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport Login from './login/Login';\nimport { BrowserRouter, Link, Route, Redirect, Switch } from 'react-router-dom';\nimport Home from './home/Home';\nimport Search from './search/Search';\nimport Grid from '@material-ui/core/Grid';\nimport UserService from '../services/user.service';\nimport ConvService from '../services/conv.service';\nimport Button from '@material-ui/core/Button';\nimport openSocket from \"socket.io-client\";\nimport io from 'socket.io-client';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Admin from './admin/Admin';\nimport TableFooter from '@material-ui/core/TableFooter';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport IconButton from '@material-ui/core/IconButton';\nimport FirstPageIcon from '@material-ui/icons/FirstPage';\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft';\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight';\nimport LastPageIcon from '@material-ui/icons/LastPage';\n\nvar axios = require('axios');\n\nvar _user = new UserService();\n\nvar _conv = new ConvService();\n\nvar socket = io('http://localhost:8000');\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.homeTemp = function (user, chat) {\n      return user ? React.createElement(Home, {\n        user: user,\n        chatSelected: chat,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }) : _this.loginEl();\n    };\n\n    _this.api = function (user) {\n      return !user ? _this.loginEl() : React.createElement(Admin, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      });\n    };\n\n    _this.getroomhistory = function () {\n      if (_this.state.roomapi) {\n        _conv.getroomhistory(_this.state.roomapi).then(function (resp) {\n          console.log(resp.data.data);\n\n          if (resp.data.success) {\n            _this.setState({\n              apiresult: JSON.stringify(resp.data.data)\n            });\n          } else {\n            _this.setState({\n              apiresult: 'room not found'\n            });\n          }\n        });\n      } else {\n        _this.setState({\n          apiresult: 'room name is empty'\n        });\n      }\n    };\n\n    _this.getallhistory = function () {\n      _conv.gethistory().then(function (resp) {\n        _this.setState({\n          apiresult: JSON.stringify(resp.data)\n        });\n      });\n    };\n\n    _this.getlog = function () {\n      _conv.getlog().then(function (resp) {\n        _this.setState({\n          apiresult: JSON.stringify(resp.data)\n        });\n      });\n    };\n\n    _this.search = function (user) {\n      return user ? React.createElement(Search, {\n        user: user,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }) : _this.loginEl();\n    };\n\n    _this.handleLogoutClick = function () {\n      localStorage.setItem('logout-event', 'logout' + Math.random());\n      socket.close();\n\n      _this.logout();\n    };\n\n    _this.logout = function () {\n      _user.user = null;\n      localStorage.removeItem('loggedUser');\n\n      _this.setState({\n        loggeduser: null\n      });\n\n      axios.defaults.headers.common['loggeduser'] = null;\n    };\n\n    _this.login = function (user) {\n      axios.defaults.headers.common['loggeduser'] = JSON.stringify(user); // for all requests\n\n      _user.setUser(user);\n\n      _this.setState({\n        loggeduser: user\n      }, function () {\n        socket.connect();\n      });\n    };\n\n    _this.state = {\n      loggeduser: JSON.parse(localStorage.getItem('loggedUser')),\n      apiresult: null,\n      roomapi: null\n    };\n    _this.handleLogoutClick = _this.handleLogoutClick.bind(_assertThisInitialized(_this));\n    _this.logout = _this.logout.bind(_assertThisInitialized(_this));\n    window.addEventListener('storage', function (event) {\n      if (event.key == 'logout-event') {\n        _this.logout();\n      } else if (event.key == 'loggedUser') {\n        axios.defaults.headers.common['loggeduser'] = localStorage.getItem('loggedUser'); // for all requests\n\n        _user.setUser(JSON.parse(localStorage.getItem('loggedUser')));\n\n        _this.setState({\n          loggeduser: JSON.parse(localStorage.getItem('loggedUser'))\n        }, function () {\n          socket.connect();\n        });\n      }\n    });\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      if (localStorage.getItem('loggedUser')) {\n        socket.connect();\n      }\n    }\n  }, {\n    key: \"loginEl\",\n    value: function loginEl() {\n      var _this2 = this;\n\n      return React.createElement(Login, {\n        login: function login(user) {\n          return _this2.login(user);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var button;\n\n      if (this.state.loggeduser) {\n        button = React.createElement(Link, {\n          to: \"/login\",\n          className: \"buttonLink\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        }, \" \", React.createElement(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          className: \"menuBtn\",\n          onClick: this.handleLogoutClick,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        }, \"Logout\"));\n      } else {\n        button = React.createElement(Link, {\n          to: \"/login\",\n          className: \"buttonLink\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }, React.createElement(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          className: \"menuBtn\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }, \"Login\"), \" \");\n      }\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(BrowserRouter, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"router\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"menuVisual\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        container: true,\n        spacing: 0,\n        className: \"menuContainer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 4,\n        className: \"menuBtn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, \"Home\"), \" \")), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 4,\n        className: \"menuBtn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, \"Find\"), \" \")), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 4,\n        className: \"menuBtn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/api\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, \"API\"), \" \")), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 4,\n        className: \"menuBtn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, button, \" \"))), React.createElement(Switch, {\n        className: \"routeWindow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, React.createElement(Route, {\n        exact: true,\n        path: \"/\",\n        render: function render() {\n          return _this3.homeTemp(_this3.state.loggeduser);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/login\",\n        render: function render() {\n          return _this3.homeTemp(_this3.state.loggeduser);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/search\",\n        render: function render() {\n          return _this3.search(_this3.state.loggeduser);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/api\",\n        render: function render() {\n          return _this3.api(_this3.state.loggeduser);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }), React.createElement(Redirect, {\n        from: \"/*\",\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport { App, axios, _user, _conv, socket };","map":{"version":3,"sources":["/Users/anna_gavrilova/my-chat/src/components/App.js"],"names":["React","Component","Login","BrowserRouter","Link","Route","Redirect","Switch","Home","Search","Grid","UserService","ConvService","Button","openSocket","io","PropTypes","withStyles","Table","TableBody","TableCell","TableHead","TableRow","Paper","Admin","TableFooter","TablePagination","IconButton","FirstPageIcon","KeyboardArrowLeft","KeyboardArrowRight","LastPageIcon","axios","require","_user","_conv","socket","App","props","homeTemp","user","chat","loginEl","api","getroomhistory","state","roomapi","then","resp","console","log","data","success","setState","apiresult","JSON","stringify","getallhistory","gethistory","getlog","search","handleLogoutClick","localStorage","setItem","Math","random","close","logout","removeItem","loggeduser","defaults","headers","common","login","setUser","connect","parse","getItem","bind","window","addEventListener","event","key","button"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport Login from './login/Login'\nimport {BrowserRouter,Link,Route,Redirect,Switch} from 'react-router-dom';\nimport Home from './home/Home';\nimport Search from './search/Search'\nimport Grid from '@material-ui/core/Grid';\nimport UserService from '../services/user.service'\nimport ConvService from '../services/conv.service'\nimport Button from '@material-ui/core/Button';\nimport openSocket from \"socket.io-client\"\nimport io from 'socket.io-client';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Admin from './admin/Admin';\nimport TableFooter from '@material-ui/core/TableFooter';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport IconButton from '@material-ui/core/IconButton';\nimport FirstPageIcon from '@material-ui/icons/FirstPage';\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft';\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight';\nimport LastPageIcon from '@material-ui/icons/LastPage';\n\n\n\n\nvar  axios=require('axios')\nvar _user=new UserService();\nvar _conv=new ConvService();\nvar socket=io('http://localhost:8000');\n\n\n\n\n\n\n\nclass App extends Component {\n  \n  constructor(props){\n    super(props);\n    this.state={\n      loggeduser:JSON.parse(localStorage.getItem('loggedUser')),\n      apiresult:null,\n      roomapi:null\n    }\n\n    this.handleLogoutClick=this.handleLogoutClick.bind(this)\n    this.logout=this.logout.bind(this)\n\n\n\n    window.addEventListener('storage', event=>{\n      if (event.key == 'logout-event') { \n        this.logout()\n      }\n      else if(event.key=='loggedUser'){\n        axios.defaults.headers.common['loggeduser'] = localStorage.getItem('loggedUser') // for all requests\n        _user.setUser(JSON.parse(localStorage.getItem('loggedUser')));\n        this.setState({loggeduser:JSON.parse(localStorage.getItem('loggedUser'))},()=>{\n\n          socket.connect()\n        })\n      }\n  });\n    \n   \n}\n\ncomponentWillMount(){\n  if(localStorage.getItem('loggedUser')){\n    socket.connect()\n  }\n}\n\n\nhomeTemp=(user,chat)=>{\n  return user?<Home user={user} chatSelected={chat}/>:this.loginEl();\n}\n\n// api=(user)=>{\n//   return !user?this.loginEl():\n//   <div className=\"Api_calls\">\n\n//     <Button variant=\"contained\" color=\"primary\" className='menuBtn' onClick={this.getlog}> Get log</Button> <br/>\n//     <Button variant=\"contained\" color=\"primary\" className='menuBtn' onClick={this.getallhistory}> Get All History</Button> <br/>\n//     <input type='text' placeholder=\"room id\" onChange={(event)=>this.setState({roomapi:event.target.value})}></input>\n//     <Button variant=\"contained\" color=\"primary\" className='menuBtn' onClick={this.getroomhistory}> Get Room History</Button> \n\n//     <div className=\"apiResult\">\n//       {this.state.apiresult}\n//     </div>\n//   </div>\n// }\n\n\napi=(user)=>{\n\n  \n  return (!user?this.loginEl():<Admin></Admin>)\n}\n\ngetroomhistory=()=>{\n  if(this.state.roomapi){\n    _conv.getroomhistory(this.state.roomapi)\n      .then(resp=>{\n        console.log(resp.data.data)\n        if(resp.data.success){\n          this.setState({\n            apiresult:JSON.stringify(resp.data.data)\n          })\n\n        }\n        else{\n          this.setState({\n            apiresult:'room not found'\n          })\n        }\n      })\n  }\n  else{\n    this.setState({\n      apiresult:'room name is empty'\n    })\n  }\n}\n\ngetallhistory=()=>{\n  _conv.gethistory()\n    .then(resp=>{\n      this.setState({\n        apiresult:JSON.stringify(resp.data)\n      })\n    })\n}\n\ngetlog=()=>{\n  _conv.getlog()\n    .then(resp=>{\n      this.setState({\n        apiresult:JSON.stringify(resp.data)\n      })\n    })\n}\n\nsearch=(user)=>{\n  return user?<Search user={user}/>:this.loginEl();\n}\n\n\n\nhandleLogoutClick=()=>{\n\n  localStorage.setItem('logout-event','logout'+Math.random())\n  socket.close()\n  this.logout()\n \n}\n\nlogout=()=>{\n  _user.user=null;\n  localStorage.removeItem('loggedUser');\n  this.setState({\n    loggeduser:null\n  });\n  axios.defaults.headers.common['loggeduser'] = null\n  \n}\n\nlogin=(user)=>{\n  axios.defaults.headers.common['loggeduser'] = JSON.stringify(user) // for all requests\n  _user.setUser(user);\n  this.setState({loggeduser:user},()=>{\n    socket.connect()\n  });\n  \n}\n\nloginEl(){\n  return(\n  <Login login={(user)=>this.login(user)}/>\n  )\n}\n\n\n  render() {\n\n    let button;\n    if (this.state.loggeduser) {\n      button =<Link to=\"/login\" className=\"buttonLink\"> <Button variant=\"contained\" color=\"primary\" className='menuBtn' onClick={this.handleLogoutClick} >\n                  Logout\n               </Button> \n               </Link>\n    } else {\n      button =\n                <Link to=\"/login\" className=\"buttonLink\"><Button variant=\"contained\" color=\"primary\" className='menuBtn'>Login</Button> </Link>\n                \n    }\n\n\n    return (\n  \n      \n      <div className=\"App\">\n      \n      <BrowserRouter>\n     \n      <div className=\"router\">\n            <div className=\"menuVisual\">\n            <Grid container spacing={0} className='menuContainer'>\n\n              <Grid item xs={12} sm={4} className='menuBtn'><Link to=\"/\"><Button variant=\"contained\" color=\"primary\" >Home</Button> </Link></Grid>\n              <Grid item xs={12} sm={4} className='menuBtn'><Link to=\"/search\"><Button variant=\"contained\" color=\"primary\" >Find</Button> </Link></Grid>\n              <Grid item xs={12} sm={4} className='menuBtn'><Link to=\"/api\"><Button variant=\"contained\" color=\"primary\" >API</Button> </Link></Grid>\n              <Grid item xs={12} sm={4} className='menuBtn'>{button} </Grid>\n\n            </Grid>\n\n            </div>\n\n\n\n\n                {/* Route for / condition on logged in and not logged in */}\n              <Switch className=\"routeWindow\">\n                <Route exact path=\"/\" render={()=>this.homeTemp(this.state.loggeduser)}/>\n                <Route path=\"/login\" render={()=>this.homeTemp(this.state.loggeduser)}/>\n                <Route path=\"/search\" render={()=>this.search(this.state.loggeduser)}/>\n                <Route path=\"/api\" render={()=>this.api(this.state.loggeduser)}/>\n                <Redirect from=\"/*\" to=\"/\" />\n              \n             </Switch>\n        </div>\n        </BrowserRouter>\n      </div>\n    );\n  }\n}\n\nexport {App,axios,_user,_conv,socket}\n"]},"metadata":{},"sourceType":"module"}